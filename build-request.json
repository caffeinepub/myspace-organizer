{
  "kind": "build_request",
  "title": "Date/Time Display Everywhere + Gold Accent Presets + Consistent Accent Application",
  "projectName": "MyOrganizer Pro",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Create a shared utility function `formatDateTime(ts: string | number | Date): string` in `frontend/src/utils/formatDateTime.ts` that returns dates in 'DD MMM YYYY, h:mm A' format (e.g. '28 Feb 2026, 3:45 AM'). If the input is a date-only string (no time component), default the time to 12:00 AM. The function must never throw — wrap parsing in a try/catch and return a safe fallback string on error.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "Create one shared formatter function and reuse it everywhere: formatDateTime(ts) -> 'DD MMM YYYY, h:mm A'",
          "If something previously stored only a date, on read fallback to time '12:00 AM' or infer existing timestamp safely (no crashes)."
        ]
      },
      "acceptanceCriteria": [
        "formatDateTime('2026-02-28T03:45:00.000Z') returns a string matching 'DD MMM YYYY, h:mm A' pattern",
        "formatDateTime('2026-02-28') returns '28 Feb 2026, 12:00 AM' (date-only fallback)",
        "formatDateTime with an invalid input returns a non-crashing fallback string"
      ]
    },
    {
      "id": "REQ-2",
      "text": "Replace all bare date-only displays throughout the app with calls to `formatDateTime`. Specifically update: streak last check-in timestamp in `StreakWidget.tsx` and `StreakPage.tsx`; record created-at in `RecordsPage.tsx`; routine item created/updated timestamps in `RoutinesPage.tsx`; note timestamps (created, updated, reminder) in `NoteCard.tsx` and `NoteModal.tsx`; todo due/created dates; habit log entries; export/import log messages in `SettingsPage.tsx`. Also ensure new timestamps are stored as `new Date().toISOString()` wherever a timestamp is written to IndexedDB.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "Anywhere the app shows a 'date' (streak last check-in, record created, routine item created/updated, note timestamps, todo due/created, habit logs, export/import logs), display BOTH: Date AND time in 12-hour format with AM/PM",
          "Store timestamps as ISO strings (new Date().toISOString())."
        ]
      },
      "acceptanceCriteria": [
        "Every timestamp visible in the UI shows both date and time in 'DD MMM YYYY, h:mm A' format",
        "Streak last check-in on StreakWidget and StreakPage shows date + time",
        "Record created-at in RecordsPage shows date + time",
        "Note created/updated in NoteCard and NoteModal shows date + time",
        "Export/import success messages in SettingsPage include formatted date + time",
        "No runtime errors when existing records have date-only stored values"
      ]
    },
    {
      "id": "REQ-3",
      "text": "Add five gold/yellow accent color presets to the accent color picker in `SettingsPage.tsx`: Gold (#D4AF37), Golden Yellow (#FFC300), Amber Gold (#FFB000), Deep Gold (#B8860B), Warm Yellow (#FFD54A). Each preset must render as a clickable color swatch button with its label. When selected, the accent color must be saved to localStorage and applied immediately across the UI. If no user preference exists in localStorage, default the accent to Gold (#D4AF37).",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "In the 'Accent Color' picker/settings, add preset buttons: Gold: #D4AF37, Golden Yellow: #FFC300, Amber Gold: #FFB000, Deep Gold: #B8860B, Warm Yellow: #FFD54A",
          "Default accent should be 'Gold (#D4AF37)' if no user preference exists."
        ]
      },
      "acceptanceCriteria": [
        "Settings page accent color section shows 5 labeled gold/yellow preset swatches",
        "Clicking a swatch updates the accent color immediately across the UI",
        "Selected swatch is visually highlighted/active",
        "On first load with no saved preference, accent defaults to #D4AF37",
        "Accent persists across page reloads via localStorage"
      ]
    },
    {
      "id": "REQ-4",
      "text": "Ensure gold accent colors are readable in both light and dark mode. For bright accents (#FFC300, #FFD54A) on white/light backgrounds, use dark text (#1a1a1a or similar) on accent-colored buttons instead of white text. Add a subtle box-shadow or border to bright accent buttons to maintain definition on light backgrounds. Derive hover and active states by darkening the accent color by ~10–15% (can be done via CSS `filter: brightness(0.88)` or a computed darker hex).",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "Ensure contrast is readable in both light and dark mode: If accent is too bright on white, use darker text or add subtle shadow/border.",
          "Buttons should have hover/active states derived from accent."
        ]
      },
      "acceptanceCriteria": [
        "Accent-colored buttons using bright gold (#FFC300, #FFD54A) display dark text in light mode",
        "Accent-colored buttons have visible hover and active state changes",
        "Bright accent buttons have a subtle border or shadow in light mode for definition",
        "Dark mode accent buttons remain legible"
      ]
    },
    {
      "id": "REQ-5",
      "text": "Introduce three CSS custom properties on the `:root` (and updated in the theme logic / `appStore.ts`): `--accent` (the chosen accent hex), `--accent-2` (the accent darkened ~15% for hover/secondary use), and `--accent-soft` (the accent at ~15% opacity for backgrounds/chips). Update `frontend/src/index.css` and `frontend/index.css` to declare these variables. Update `appStore.ts` `applyAccent` (or equivalent) to compute and set all three variables on the document root whenever the accent changes.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "Add CSS variables: --accent, --accent-2 (slightly darker), --accent-soft (transparent)",
          "Update theme generator (if present) to respect the new gold accents"
        ]
      },
      "acceptanceCriteria": [
        "`--accent`, `--accent-2`, and `--accent-soft` are present on :root when the app loads",
        "Changing the accent color updates all three variables immediately",
        "Components using `var(--accent)` reflect the current user selection"
      ]
    },
    {
      "id": "REQ-6",
      "text": "Apply the accent color consistently across all primary interactive and visual elements by replacing hardcoded color classes with `var(--accent)` references (inline styles or CSS classes). Elements to update: primary CTA buttons (Add, Save, Check In, Export, Import), active nav tab indicator in `BottomTabBar.tsx` and `AppSidebar.tsx`, selected/active chip backgrounds in filters and label selectors, progress bars and progress highlights, the streak ring/circle in `StreakWidget.tsx` and `StreakPage.tsx`, and routine timeline markers/dots in `RoutinesPage.tsx`.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "All primary CTAs, active nav tab indicator, selected chips, progress highlights, streak ring, routine timeline markers should use the accent color.",
          "keep the UI premium (glass + soft gradients)"
        ]
      },
      "acceptanceCriteria": [
        "Primary CTA buttons use `var(--accent)` for background",
        "Active bottom tab and sidebar nav item uses `var(--accent)` for indicator/highlight",
        "Selected filter chips use `var(--accent-soft)` background with `var(--accent)` border or text",
        "Streak ring/circle stroke or fill uses `var(--accent)`",
        "Routine timeline markers use `var(--accent)`",
        "Changing accent color in settings updates all these elements immediately"
      ]
    }
  ],
  "constraints": [
    "Do not remove any existing features — all current functionality (notes, routines, streaks, records, quotes, settings, PWA) must remain intact.",
    "Do not edit files under frontend/src/hooks/useInternetIdentity.ts, frontend/src/hooks/useActor.ts, frontend/src/main.tsx, or frontend/src/components/ui.",
    "The formatDateTime utility must be a single shared function imported everywhere — do not duplicate date formatting logic."
  ],
  "nonGoals": [
    "Adding new pages or major new features beyond those specified",
    "Converting the app to a native mobile APK",
    "Changing the backend Motoko code",
    "Adding new color themes beyond the gold/yellow accent presets requested",
    "Modifying the PWA manifest or service worker"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}